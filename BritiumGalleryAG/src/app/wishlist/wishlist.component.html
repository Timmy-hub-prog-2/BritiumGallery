<div class="wishlist-container">
  <!-- Header Section -->
  <div class="wishlist-header">
    <div class="header-content">
      <div class="header-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
        </svg>
      </div>
      <div class="header-text">
        <h1 class="wishlist-title">Your Wishlist</h1>
        <p class="wishlist-subtitle" *ngIf="wishlist.length > 0">{{ wishlist.length }} item{{ wishlist.length === 1 ? '' : 's' }} saved for later</p>
        <p class="wishlist-subtitle" *ngIf="wishlist.length === 0">Save your favorite items here</p>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="wishlist.length === 0" class="empty-state">
    <div class="empty-content">
      <div class="empty-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
        </svg>
      </div>
      <h3 class="empty-title">Your wishlist is empty</h3>
      <p class="empty-description">Start adding items you love to keep track of them</p>
      <button class="browse-btn" (click)="goToBrowse()">
        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="11" cy="11" r="8"/>
          <path d="m21 21-4.35-4.35"/>
        </svg>
        Browse Products
      </button>
    </div>
  </div>

  <!-- Wishlist Grid -->
  <div class="wishlist-grid" *ngIf="wishlist.length > 0">
    <div class="wishlist-card" *ngFor="let item of wishlist; let i = index">
      <div class="card-number">{{ i + 1 }}</div>
      
      <div class="wishlist-image-container" (click)="goToProductDetail(item.productId)">
        <img
          [src]="item.productPhotoUrl"
          alt="Product Image"
          class="wishlist-image"
        />
        <div class="image-overlay">
          <div class="overlay-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
              <circle cx="12" cy="12" r="3"/>
            </svg>
          </div>
        </div>
      </div>

      <div class="wishlist-card-body">
        <div class="product-header">
          <h3 class="product-name">{{ item.productName }}</h3>
          <div class="product-id">
            <svg class="id-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
              <polyline points="14,2 14,8 20,8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
              <polyline points="10,9 9,9 8,9"/>
            </svg>
            ID: {{ item.productId }}
          </div>
        </div>

        <div class="product-info">
          <div class="product-attributes" *ngIf="productDetails[item.productId] as detail">
            <div class="attributes-header">
              <svg class="attr-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
              </svg>
              <span class="attr-label">Available Options:</span>
            </div>
            <div *ngIf="getAttributeCounts(detail) as attrCounts" class="attributes-list">
              <div class="attribute-item" *ngFor="let attr of (attrCounts | keyvalue)">
                <span class="attr-name">{{ attr.key }}:</span>
                <span class="attr-value">{{ attr.value }} option{{ attr.value === 1 ? '' : 's' }}</span>
              </div>
            </div>
          </div>

          <div class="product-price" *ngIf="productDetails[item.productId]">
            <div class="price-header">
              <svg class="price-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <line x1="12" y1="1" x2="12" y2="23"/>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
              </svg>
              <span class="price-label">Price Range:</span>
            </div>
            <div class="price-value">{{ getPriceRange(productDetails[item.productId]) }}</div>
          </div>
        </div>
      </div>

      <div class="wishlist-actions">
        <button class="remove-btn" 
                (click)="removeFromWishlist(item.productId)"
                title="Remove from wishlist">
          <svg class="heart-icon filled" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
          </svg>
          <span class="btn-text">Remove</span>
        </button>
        
        <button class="view-btn" (click)="goToProductDetail(item.productId)">
          <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
            <circle cx="12" cy="12" r="3"/>
          </svg>
          <span class="btn-text">View Product</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Wishlist Actions -->
  <div class="wishlist-footer" *ngIf="wishlist.length > 0">
    <div class="footer-content">
      <div class="footer-stats">
        <div class="stat-item">
          <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
          </svg>
          <span class="stat-value">{{ wishlist.length }}</span>
          <span class="stat-label">Saved Items</span>
        </div>
      </div>
      
      <div class="footer-actions">
        <button class="footer-btn secondary" (click)="clearWishlist()" *ngIf="wishlist.length > 1">
          <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <polyline points="3,6 5,6 21,6"/>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
          </svg>
          Clear All
        </button>
        
        <button class="footer-btn primary" (click)="goToBrowse()">
          <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <circle cx="11" cy="11" r="8"/>
            <path d="m21 21-4.35-4.35"/>
          </svg>
          Continue Shopping
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Helper for color count -->
<ng-template #colorCount let-detail>
  {{ getColorCount(detail) }}
</ng-template>
